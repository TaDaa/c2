!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.c2=n():t.c2=n()}(this,function(){return function(t){function n(i){if(e[i])return e[i].exports;var r=e[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}var e={};return n.m=t,n.c=e,n.p="",n(0)}([function(t,n,e){t.exports=e(1)},function(t,n,e){(function(n){n.c2=function(){},c2.element=c2.create=function(t){return new this.Drawable(t)},c2.animate=e(2),c2.registry=e(3),c2.invalidator=e(4),c2.types=e(5),c2.Base=e(6),c2.Drawable=e(7),c2.Context2d=e(8),c2.Layer2d=e(10),c2.createElement=e(9),t.exports=c2}).call(n,function(){return this}())},function(t,n){function e(t){function n(t){n.tween("",n._compile()),pending[pending_cnt++]={selection:t,animation:n},!c2_timer_running&&(c2_timer_running=!0,requestAnimationFrame(c))}return n._name=t||"",n._ease=u,n._delay=p,n._duration=f,n._tween_map={},n._to={},n._compiled={},n._compiled_fn=void 0,n._tweens=[],n._compile=_,n.duration=i,n.delay=r,n.ease=o,n.tween=l,n._remove=!1,n.to=d,n.on=s,n.remove=a,n}function i(t){return arguments.length?(this._duration=t,this):this._duration}function r(t){return arguments.length?(this._delay=t,this):this._delay}function o(t){return arguments.length?(this._ease=t,this):this._ease}function a(){return this._remove=!0,this}function s(t,n){return"end"===t?!this._on_end&&(this._on_end=[n])||this._on_end.push(n):"start"===t&&(!this._on_start&&(this._on_start=[n])||this._on_start.push(n)),this}function _(){var t,n=this,e=this._to,i="(function (to,n) {return function (d,i,g) {",r=["var me=this"],o=[],a=[],s=this._compiled,_=!1,d=0;if(s){for(t in e)if(s[t]!==e[t]){_=!0;break}if(_===!1)return this._compiled_fn}s=this._compiled={};for(t in e)s[t]=e[t],r.push("s"+d+'=this["'+t+'"]',"v"+d+"="+("function"==typeof e[t]&&'to["'+t+'"].call(this,d,i,g)'||'to["'+t+'"]'),"t"+d+"=typeof v"+d+' === "number" && 1 || 0'),o.push("if (t"+d+"===1) {s"+d+"=+s"+d+"||0;v"+d+"-=s"+d+";} else {v"+d+"=d3.interpolate(s"+d+",v"+d+");}"),a.push("if (t"+d+'===1) {m["'+t+'"]=s'+d+"+v"+d+'*t;} else {m["'+t+'"]=v'+d+"(t);}"),d++;return i+=r.join(",")+";",i+=o.join(""),i+="return function (t,e) {var m = me;",i+=a.join(""),i+="m._invalid_===0 && m.invalidate();",i+="e === 1 && (n(m,d,i,g));",i+="}",i+="}})",this._compiled_fn=(0,eval)(i)(e,function(t,e,i){var r;if(n._remove&&t.parentNode&&t.parentNode.removeChild(t),r=n._on_end){var i,o;for(i=0,o=r.length;i<o;i++)r.call(t,e,i,g)}})}function d(t,n){if(arguments.length>1)this._to[t]=n;else if("object"==typeof t){var e;for(e in t)this._to[e]=t[e]}return this}function l(t,n){return arguments.length>1?((index=this._tween_map[t])?this._tweens[index]=n:this._tween_map[t]=this._tweens.push(n)-1,this):this._tweens[this._tween_map[t]]||null}function h(t){var n,e,i,r,o,a,s,_,d,l,h,c,u,p,f,v,g,m,x,w,y,b,N,k,V,C,A,j,I,D=ease_groups,S=pending,E=available_start_indices.length,q=t;for(n=0,e=pending_cnt;n<e;n++){for(j=S[n],A=j.animation,I=j.selection,I._started=!0,d=I._groups,g=A._delay,m=A._duration,y=A._tweens,b=A._name,v=A._ease,x="function"==typeof g,w="function"==typeof m,i=0,r=d.length;i<r;i++)for(l=d[i],o=0,a=l.length;o<a;o++)if(h=l[o]){if(h._c2_transition&&(k=h._c2_transition,u=k[b],void 0!==u)){for(c=u.tween_group,s=0,_=u.length;s<_;s++)c[u[s]]=!1;0!==c.cnt&&(c.cnt-=_)<=0&&(c.cnt=c.length=0)}for(p=x===!0?q+g.call(h,h.__data__,o,l):q+g,f=w===!0?m.call(h,h.__data__,o,l):m,V=p+"-"+f,(N=start_duration_map[V])?(C=N.indexOf(v),C!==-1?c=N[C+1]:(N.push(v,c=[]),c.cnt=0)):(E>0?(E--,C=available_start_indices.shift()):C=start_duration_end_index+1,N=D[C/2]=start_duration_map[V]=[v,c=[]],c.cnt=0,start_durations[C]=p,start_durations[++C]=f,C>start_duration_end_index&&(start_duration_end_index=C)),k=h._c2_transition,void 0===k&&(k=h._c2_transition={}),u=k[b]=[],u.tween_group=c,s=0,_=y.length;s<_;s++)u[s]=c.push(y[s].call(h,h.__data__,s,l))-1;c.cnt+=_}S[n]=void 0}pending_cnt=0}function c(){var t,n,e,i,r,o,a,s,_,d,l,u,p=Date.now(),f=0,v=0,g=!1;if((n=pending_cnt)&&h(p),start_duration_end_index>0){for(t=0,e=0,o=0,n=start_duration_end_index;t<n;t++,o++)if(f=start_durations[t++],f!==-1&&p>f){if(d=start_durations[t],d>0){if(v=(p-f)/d,v>=1&&(v=1),r=ease_groups[o])for(e=0,i=r.length;e<i;e++,e++)if(u=r[e+1],s=u.length)for(_=r[e](v),a=0;a<s;a++)(l=u[a])&&l(_,v)}else v=1;1===v&&(available_start_indices.push(t-1),delete start_duration_map[start_durations[t-1]+"-"+start_durations[t]],start_durations[t-1]=start_durations[t]=-1,ease_groups[o]=!1,t===start_duration_end_index&&(g=!0))}if(g===!0)for(t=start_duration_end_index;t>=-1;t--)if(start_durations[t]!==-1){start_duration_end_index=t;break}}pending_cnt>0||start_duration_end_index>0?requestAnimationFrame(c):c2_timer_running=!1}t.exports=function(t){return new e(t)};var u=function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2},p=0,f=250;window.start_durations=[],window.available_start_indices=[],window.start_duration_end_index=-1,window.ease_groups=[],window.start_duration_map={},window.transitionIds=1,window.pending=[],window.pending_cnt=0,window.c2_timer_running=!1},function(t,n){var e=[];t.exports=e},function(t,n){function e(){e.timeout=!1,e.t2||(e.t2=requestAnimationFrame(i))}function i(){e.t2=!1;var t,n,i,s,_,d=r,l=o,h=a,c=0;for(u=0,p=h.length;u<p;u++){for(_=h[u],s=_.children,t=i=_._invalid_children_,cnt=0,n=s.length;i<n;t++,i++){if(_=s[i],void 0===_)for(;void 0===_&&i<n;)c++,_=s[++i];c>0&&_&&(s[t]=_,_.parentIndex=t)}h[u]._invalid_children_=-1,s.length&&(s.length-=i-t)}h.index=0;for(var u=0,p=0|d.index;u<p;u++)d[u].render();for(d.index=0,u=0,p=0|l.index;u<p;u++)_=l[u],_._invalid_=0,void 0!==_.__changed__&&(_.__changed__.length=0);l.index=0}var r=[],o=[],a=[];a.index=r.index=o.index=0,e.timeout=!1,e.parents=r,e.cleanup=o,e.children=a,t.exports=e},function(t,n){var e={"int":{defaultValue:0,setValue:"v|0"},"float":{defaultValue:0,setValue:"v"},string:{defaultValue:"",setValue:"v"},object:{defaultValue:null,setValue:"v"},array:{defaultValue:null,setValue:"v"},any:{defaultValue:null,setValue:"v"}};t.exports=e},function(t,n,e){function i(){this._events={}}function r(t){t.parentNode&&t.parentNode.removeChild(t);var n=this.children&&(t.parentIndex=this.children.push(t)-1,t.parentNode=this,t)||null;return 0===this._invalid_&&null!==n&&this.invalidate(),n}function o(t,n){t.parentNode&&t.parentNode.removeChild(t);var e=this.children,i=-1;return e?(n&&n.parentNode===this&&(i=e.indexOf(n)),i!==-1?(t.parentIndex=i,e.splice(i,0,t)):t.parentIndex=e.push(t)-1,t.parentNode=this):t=null,t&&0===this._invalid_&&this.invalidate(),t}function a(t){if(t.parentNode===this)return this._invalid_children_===-1&&(this._invalid_children_=0|t.parentIndex,this._invalid_children[this._invalid_children.index++]=this),this._invalid_children_>t.parentIndex&&(this._invalid_children_=t.parentIndex),this.children[t.parentIndex]=void 0,t.parentIndex=-1,t.parentNode=void 0,0===this._invalid_&&null!==result&&this.invalidate(),t}function s(t){var n,e,i=this.children;if(i)for(var r=0,o=i.length;r<o;r++)if(n=i[r]){if(n._c2_proto===t)return n;if(n.children&&n.children.length&&(e=s.call(n,t)))return e}return null}function _(t,n){var e,i=this.children,r=n||[];if(i)for(var o=0,a=i.length;o<a;o++)(e=i[o])&&(e._c2_proto===t&&r.push(e),e.children&&e.children.length&&_.call(e,t,r));return r}function d(t,n){var e=this._events;return e[t]&&e[t].push(n)||(e[t]=[n]),!0}function l(t,n){var e=this._events[t],i=e?e.indexOf(n):-1;return i!==-1&&(e.splice(i,1),!0)}function h(t,n){var e=t,i=n;this[e]=i,0===this._invalid_&&this.invalidate()}function c(t){return this[t]}function u(t){this[t]=void 0,0===this._invalid_&&this.invalidate()}function p(){0===this._invalid_&&(this._invalid_cleanup[this._invalid_cleanup.index++]=this,this._invalid_=1,void 0!==this.parentNode.__changed__?(0===this.parentNode._invalid_&&this.parentNode.invalidate(),this.parentNode.__changed__.push(this)):(this.parentNode.__changed__=[this],0===this.parentNode._invalid_&&this.parentNode.invalidate()))}var f=e(4),v=e(3);i.prototype._invalid_=0,i.prototype._invalid_cleanup=f.cleanup,i.prototype._invalid_parents=f.parents,i.prototype._invalid_children_=-1,i.prototype._invalid_children=f.children,i.prototype.registry=v,i.prototype.invalidator=f,i.prototype.appendChild=r,i.prototype.insertBefore=o,i.prototype.removeChild=a,i.prototype.querySelector=s,i.prototype.querySelectorAll=_,i.prototype.addEventListener=d,i.prototype.removeEventListener=l,i.prototype.setAttribute=h,i.prototype.getAttribute=c,i.prototype.removeAttribute=u,i.prototype.render=i.prototype.oninvalid=i.prototype.ontock=i.prototype.ontick=void 0,i.prototype.invalidate=p,i.prototype._events=void 0,p.compiled=p.toString().replace(/\n|\t|[\s]{2,}/g,"").match(/([^\{]*)(.*)/)[2].slice(1,-1),t.exports=i},function(t,n,e){function i(t){var n=this.registry.push(this)-1;if(this._c2_proto=this,this._c2_id=n,this._isDrawable=!0,!t)throw console.error("trace"),new Error("Render function must be provided to Drawable constructor");this.render=t}function r(t){var n,e,i=[],r=[],o=[];this._attributes=t;for(n in t)e=t[n],this[n]=t[n].defaultValue,i.push('if (n === "'+n+'" ) {this["'+n+'"]='+t[n].setValue+";}"),o.push('if (n === "'+n+'") {this["'+n+'"]=null;}'),r.push('if (n === "'+n+'") {return this["'+n+'"];}');return this.setAttribute=(0,eval)("(function c2_setAttribute (k,b) {var n=k,v=b; "+i.join("else ")+"else {this[n]=v;} "+this.invalidate.compiled+"})"),this.getAttribute=(0,eval)("(function (k) {var n=k;"+r.join("else ")+" else {return this[n];}})"),this.removeAttribute=(0,eval)("(function (k) {var n=k;"+o.join("else ")+"else {this[n]=null} if (this._invalid_ === 0) {"+this.invalidate.compiled+"}})"),this}function o(t){return this._constructor=t,this}function a(t){var n;for(n in t)this[n]=t[n];return this}function s(){var t,n,e="(function () {",i=this._attributes;for(t in i)n=i[t].defaultValue,e+='this["'+t+'"]='+(""===n&&'""'||n)+";";return e+="this._invalid_cleanup=this._invalid_cleanup;this._invalid_parents=this._invalid_parents;this._invalid_children=this._invalid_children;this._invalid_children_=-1;this._invalid_=0;",e+="this._constructor && this._constructor();})",result=(0,eval)(e),result.prototype=this,result}function _(){return this._c2_id}var d=e(6);i.prototype=new d,i.prototype.attributes=r,i.prototype.constructor=o,i.prototype.proto=a,i.prototype.compile=s,i.prototype.toString=_,t.exports=i},function(t,n,e){function i(t){var n,e=this._events,i=e.tock,r=e.tick,o=this.context,a=this.children;if(r)for(var s=0,_=r.length;s<_;s++)r[s].call(this,o);for(s=0,_=a.length;s<_;s++)n=a[s],n.render(o,n.__data__,s,n.__changed__);if(i)for(s=0,_=i.length;s<_;s++)i[s].call(this,o)}function r(t,n){return a(n)}function o(){0===this._invalid_&&(this._invalid_=1,this._invalid_cleanup[this._invalid_cleanup.index++]=this,this._invalid_parents[this._invalid_parents.index++]=this,this.invalidator())}var a=e(9),s=e(7),_=e(5);Context2d=new s(i).proto({invalidate:o,createElementNS:r}).attributes({fillStyle:_.string,globalAlpha:_["float"],lineWidth:_["float"],strokeStyle:_.string,shadowColor:_.string,shadowBlur:_["float"],shadowOffsetX:_["float"],shadowOffsetY:_["float"]}),o.compiled=o.toString().replace(/\n|\t|[\s]{2,}/g,"").match(/([^\{]*)(.*)/)[2].slice(1,-1),t.exports=function(){if(this._c2Context2d_)return this._c2Context2d_;var t=c2.createElement(Context2d);return t.canvas=this,t.context=this.getContext("2d"),t.children=[],t.ownerDocument=t,this._c2Context2d_=t,t._events={},t}},function(t,n,e){var i=e(3);t.exports=function(t){var n;return"string"==typeof t?n=i[0|t]:t._isDrawable===!0&&(n=t),n.c2_renderable||(n.c2_renderable=n.compile()),n=new n.c2_renderable,n.ownerDocument=c2,n}},function(t,n,e){var i=e(7),r=e(5);t.exports=new i(function(t,n,e,i){var r,o,a,s=this._events,_=this.context,d=s.tock,l=s.tick,h=this.children;if(this.width&&this.width!==this.canvas.width&&(this.canvas.width=this.width),this.height&&this.height!==this.canvas.height&&(this.canvas.height=this.height),l)for(r=0,o=0|l.length;r<o;r++)l[r].call(this,_);if(this._forced||i&&i.length)for(this._forced&&(this._forced=!1),r=0,o=0|h.length;r<o;r++)a=h[r],a.render(_,a.__data__,r,a.__changed__);if(d)for(r=0,o=0|d.length;r<o;r++)d[r].call(this,_);t.drawImage(this.canvas,0|this.x,0|this.y)}).constructor(function(){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.children=[],this._events={}}).attributes({x:r["int"],y:r["int"],width:r["int"],height:r["int"]}).proto({forceUpdate:function(){this._forced=!0}})}])});